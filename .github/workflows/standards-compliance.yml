# Copyright (C) 2026 Moko Consulting <hello@mokoconsulting.tech>
# SPDX-License-Identifier: GPL-3.0-or-later
# FILE INFORMATION
# DEFGROUP: GitHub.Workflow
# INGROUP: MokoStandards.Compliance
# REPO: https://github.com/mokoconsulting-tech/MokoStandards
# PATH: /.github/workflows/standards-compliance.yml
# VERSION: 02.00.00
# BRIEF: MokoStandards compliance validation workflow
# NOTE: Validates repository structure, documentation, and coding standards

name: Standards Compliance

env:
  ACTIONS_STEP_DEBUG: true
  ACTIONS_RUNNER_DEBUG: true

# MokoStandards Policy Compliance:
# - File formatting: Enforces organizational coding standards
# - Reference: docs/policy/file-formatting.md

# â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
# â”‚                         WORKFLOW FLOW DIAGRAM                            â”‚
# â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
#
#   TRIGGER: Push/PR to main/dev/rc branches
#        â”‚
#        â–¼
#   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
#   â”‚              PARALLEL VALIDATION CHECKS                      â”‚
#   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
#        â”‚
#        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
#        â–¼             â–¼              â–¼              â–¼            â–¼
#   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
#   â”‚Repository  â”‚File Header  â”‚Code Styleâ”‚  â”‚  Docs   â”‚  â”‚ License  â”‚
#   â”‚Structureâ”‚  â”‚ Validationâ”‚  â”‚  Check   â”‚  â”‚  Check  â”‚  â”‚  Check   â”‚
#   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
#        â”‚             â”‚              â”‚              â”‚            â”‚
#        â–¼             â–¼              â–¼              â–¼            â–¼
#   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
#   â”‚  Check  â”‚  â”‚  Verify  â”‚  â”‚   Run    â”‚  â”‚  Check  â”‚  â”‚  Verify  â”‚
#   â”‚Required â”‚  â”‚Copyright â”‚  â”‚ Linters  â”‚  â”‚README   â”‚  â”‚SPDX-ID   â”‚
#   â”‚  Dirs   â”‚  â”‚  Header  â”‚  â”‚(Python,  â”‚  â”‚  Exists â”‚  â”‚ Present  â”‚
#   â”‚         â”‚  â”‚  Format  â”‚  â”‚PHP,YAML) â”‚  â”‚         â”‚  â”‚          â”‚
#   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
#        â”‚             â”‚              â”‚              â”‚            â”‚
#        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
#                                     â”‚
#                                     â–¼
#                           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
#                           â”‚  All Checks Pass?â”‚
#                           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
#                              â”‚            â”‚
#                          YES â”‚            â”‚ NO
#                              â–¼            â–¼
#                       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
#                       â”‚  SUCCESS â”‚  â”‚ CREATE ISSUE â”‚
#                       â”‚  Summary â”‚  â”‚ with Failure â”‚
#                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   Details    â”‚
#                                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

on:
  push:
    branches:
      - main
      - dev/**
      - rc/**
  pull_request:
    branches:
      - main
      - dev/**
      - rc/**
  workflow_dispatch:

permissions:
  contents: read
  pull-requests: write

jobs:
  repository-structure:
    name: Repository Structure Validation
    runs-on: ubuntu-latest

    steps:
      - name: Checkout Repository
        uses: actions/checkout@v4

      - name: Check Required Directories
        run: |
          set -x
          echo "## ðŸ“ Repository Structure Validation" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY

          MISSING=0
          PRESENT=0
          TOTAL=3

          echo "### Required Directories" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "| Directory | Status | Files | Size | Notes |" >> $GITHUB_STEP_SUMMARY
          echo "|-----------|--------|-------|------|-------|" >> $GITHUB_STEP_SUMMARY

          # Check required directories
          for dir in docs scripts .github; do
            if [ -d "$dir" ]; then
              FILE_COUNT=$(find "$dir" -type f 2>/dev/null | wc -l)
              DIR_SIZE=$(du -sh "$dir" 2>/dev/null | cut -f1)
              echo "| $dir/ | âœ… Pass | $FILE_COUNT files | $DIR_SIZE | Complete |" >> $GITHUB_STEP_SUMMARY
              PRESENT=$((PRESENT + 1))
            else
              echo "| $dir/ | âŒ **Missing** | - | - | **Action Required** |" >> $GITHUB_STEP_SUMMARY
              MISSING=$((MISSING + 1))
            fi
          done

          echo "" >> $GITHUB_STEP_SUMMARY
          PERCENT=$((PRESENT * 100 / TOTAL))
          echo "**Compliance Score:** $PERCENT% ($PRESENT/$TOTAL directories present)" >> $GITHUB_STEP_SUMMARY

          if [ "$MISSING" -gt 0 ]; then
            echo "" >> $GITHUB_STEP_SUMMARY
            echo "### ðŸ”´ Critical Issues: $MISSING" >> $GITHUB_STEP_SUMMARY
            echo "" >> $GITHUB_STEP_SUMMARY
            echo "**Remediation Steps:**" >> $GITHUB_STEP_SUMMARY
            [ ! -d "docs" ] && echo "- Create docs directory: \`mkdir docs && echo '# Documentation' > docs/README.md\`" >> $GITHUB_STEP_SUMMARY
            [ ! -d "scripts" ] && echo "- Create scripts directory: \`mkdir scripts && touch scripts/.gitkeep\`" >> $GITHUB_STEP_SUMMARY
            [ ! -d ".github" ] && echo "- Create .github directory: \`mkdir -p .github/workflows\`" >> $GITHUB_STEP_SUMMARY
            echo "" >> $GITHUB_STEP_SUMMARY
            echo "ðŸ“š Reference: [MokoStandards Repository Structure](https://github.com/mokoconsulting-tech/MokoStandards/tree/main/docs/policy/core-structure.md)" >> $GITHUB_STEP_SUMMARY
            exit 1
          fi

      - name: Check Required Files
        run: |
          set -x
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "### Required Files" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY

          MISSING=0
          PRESENT=0
          TOTAL=6

          echo "| File | Status | Size | Last Modified | Notes |" >> $GITHUB_STEP_SUMMARY
          echo "|------|--------|------|---------------|-------|" >> $GITHUB_STEP_SUMMARY

          # Check required files
          for file in README.md LICENSE CONTRIBUTING.md SECURITY.md CHANGELOG.md .editorconfig; do
            if [ -f "$file" ]; then
              FILE_SIZE=$(wc -c < "$file" 2>/dev/null | awk '{printf "%.1f KB", $1/1024}')
              LAST_MOD=$(stat -c %y "$file" 2>/dev/null | cut -d' ' -f1 || echo "Unknown")
              CONTENT_CHECK=""

              # Basic content validation
              case "$file" in
                "README.md")
                  LINES=$(wc -l < "$file")
                  [ "$LINES" -lt 10 ] && CONTENT_CHECK="âš ï¸ Too short"
                  ;;
                "LICENSE")
                  [ $(wc -c < "$file") -lt 100 ] && CONTENT_CHECK="âš ï¸ Incomplete?"
                  ;;
              esac

              echo "| $file | âœ… Pass | $FILE_SIZE | $LAST_MOD | Complete $CONTENT_CHECK |" >> $GITHUB_STEP_SUMMARY
              PRESENT=$((PRESENT + 1))
            else
              echo "| $file | âŒ **Missing** | - | - | **Required** |" >> $GITHUB_STEP_SUMMARY
              MISSING=$((MISSING + 1))
            fi
          done

          echo "" >> $GITHUB_STEP_SUMMARY
          PERCENT=$((PRESENT * 100 / TOTAL))
          echo "**Compliance Score:** $PERCENT% ($PRESENT/$TOTAL files present)" >> $GITHUB_STEP_SUMMARY

          if [ "$MISSING" -gt 0 ]; then
            echo "" >> $GITHUB_STEP_SUMMARY
            echo "### ðŸ”´ Critical Issues: $MISSING" >> $GITHUB_STEP_SUMMARY
            echo "" >> $GITHUB_STEP_SUMMARY
            echo "**Remediation Steps:**" >> $GITHUB_STEP_SUMMARY
            [ ! -f "README.md" ] && echo "- Create README.md: Use [template](https://github.com/mokoconsulting-tech/MokoStandards/tree/main/templates/docs/required/README.md)" >> $GITHUB_STEP_SUMMARY
            [ ! -f "LICENSE" ] && echo "- Add LICENSE file: Choose from [OSI-approved licenses](https://opensource.org/licenses)" >> $GITHUB_STEP_SUMMARY
            [ ! -f "CONTRIBUTING.md" ] && echo "- Create CONTRIBUTING.md: Use [template](https://github.com/mokoconsulting-tech/MokoStandards/tree/main/templates/docs/required/CONTRIBUTING.md)" >> $GITHUB_STEP_SUMMARY
            [ ! -f "SECURITY.md" ] && echo "- Create SECURITY.md: Use [template](https://github.com/mokoconsulting-tech/MokoStandards/tree/main/templates/docs/required/SECURITY.md)" >> $GITHUB_STEP_SUMMARY
            [ ! -f "CHANGELOG.md" ] && echo "- Create CHANGELOG.md: Follow [Keep a Changelog](https://keepachangelog.com/)" >> $GITHUB_STEP_SUMMARY
            [ ! -f ".editorconfig" ] && echo "- Add .editorconfig: Use [template](https://github.com/mokoconsulting-tech/MokoStandards/tree/main/templates/.editorconfig)" >> $GITHUB_STEP_SUMMARY
            echo "" >> $GITHUB_STEP_SUMMARY
            echo "ðŸ“š Reference: [MokoStandards File Requirements](https://github.com/mokoconsulting-tech/MokoStandards/tree/main/docs/policy/file-header-standards.md)" >> $GITHUB_STEP_SUMMARY
            exit 1
          fi

  documentation-quality:
    name: Documentation Quality Check
    runs-on: ubuntu-latest

    steps:
      - name: Checkout Repository
        uses: actions/checkout@v4

      - name: Validate README.md
        run: |
          set -x
          echo "## ðŸ“š Documentation Quality Check" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "### README.md Analysis" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY

          if [ ! -f "README.md" ]; then
            echo "âŒ **Critical:** README.md not found" >> $GITHUB_STEP_SUMMARY
            exit 1
          fi

          # Detailed content analysis
          SIZE=$(wc -c < README.md)
          LINES=$(wc -l < README.md)
          WORDS=$(wc -w < README.md)
          HEADINGS=$(grep -c "^#" README.md || echo 0)
          LINKS=$(grep -c "\[.*\](.*)" README.md || echo 0)
          CODE_BLOCKS=$(grep -c '```' README.md || echo 0)

          echo "| Metric | Value | Status | Recommendation |" >> $GITHUB_STEP_SUMMARY
          echo "|--------|-------|--------|----------------|" >> $GITHUB_STEP_SUMMARY

          # Size check
          SIZE_STATUS="âœ… Good"
          SIZE_REC="Adequate length"
          if [ "$SIZE" -lt 500 ]; then
            SIZE_STATUS="âš ï¸ Warning"
            SIZE_REC="Add more content (min 500 bytes)"
          elif [ "$SIZE" -gt 50000 ]; then
            SIZE_STATUS="âš ï¸ Warning"
            SIZE_REC="Consider splitting into multiple docs"
          fi
          echo "| Size | $SIZE bytes | $SIZE_STATUS | $SIZE_REC |" >> $GITHUB_STEP_SUMMARY

          # Line count
          LINES_STATUS="âœ… Good"
          LINES_REC="Good size"
          if [ "$LINES" -lt 20 ]; then
            LINES_STATUS="âš ï¸ Warning"
            LINES_REC="Add more sections (min 20 lines)"
          fi
          echo "| Lines | $LINES | $LINES_STATUS | $LINES_REC |" >> $GITHUB_STEP_SUMMARY

          # Word count
          WORDS_STATUS="âœ… Good"
          WORDS_REC="Good detail"
          if [ "$WORDS" -lt 100 ]; then
            WORDS_STATUS="âš ï¸ Warning"
            WORDS_REC="Add more description (min 100 words)"
          fi
          echo "| Words | $WORDS | $WORDS_STATUS | $WORDS_REC |" >> $GITHUB_STEP_SUMMARY

          # Headings
          HEADINGS_STATUS="âœ… Good"
          HEADINGS_REC="Well structured"
          if [ "$HEADINGS" -lt 3 ]; then
            HEADINGS_STATUS="âš ï¸ Warning"
            HEADINGS_REC="Add more sections (min 3 headings)"
          fi
          echo "| Headings | $HEADINGS | $HEADINGS_STATUS | $HEADINGS_REC |" >> $GITHUB_STEP_SUMMARY

          # Links
          LINKS_STATUS="âœ… Good"
          LINKS_REC="Includes references"
          if [ "$LINKS" -lt 1 ]; then
            LINKS_STATUS="â„¹ï¸ Info"
            LINKS_REC="Consider adding useful links"
          fi
          echo "| Links | $LINKS | $LINKS_STATUS | $LINKS_REC |" >> $GITHUB_STEP_SUMMARY

          # Code blocks
          CODE_STATUS="âœ… Good"
          CODE_REC="Includes examples"
          if [ "$CODE_BLOCKS" -eq 0 ]; then
            CODE_STATUS="â„¹ï¸ Info"
            CODE_REC="Consider adding code examples"
          fi
          echo "| Code blocks | $CODE_BLOCKS | $CODE_STATUS | $CODE_REC |" >> $GITHUB_STEP_SUMMARY

          echo "" >> $GITHUB_STEP_SUMMARY

          # Check for key sections
          echo "**Section Coverage:**" >> $GITHUB_STEP_SUMMARY
          MISSING_COUNT=0
          grep -qi "install\|setup\|getting started" README.md && echo "- âœ… Installation/Setup instructions" >> $GITHUB_STEP_SUMMARY || { echo "- âš ï¸ Missing: Installation/Setup" >> $GITHUB_STEP_SUMMARY; MISSING_COUNT=$((MISSING_COUNT + 1)); }
          grep -qi "usage\|example\|how to" README.md && echo "- âœ… Usage examples" >> $GITHUB_STEP_SUMMARY || { echo "- âš ï¸ Missing: Usage examples" >> $GITHUB_STEP_SUMMARY; MISSING_COUNT=$((MISSING_COUNT + 1)); }
          grep -qi "license" README.md && echo "- âœ… License information" >> $GITHUB_STEP_SUMMARY || { echo "- âš ï¸ Missing: License information" >> $GITHUB_STEP_SUMMARY; MISSING_COUNT=$((MISSING_COUNT + 1)); }
          grep -qi "contribut" README.md && echo "- âœ… Contributing guidelines" >> $GITHUB_STEP_SUMMARY || echo "- â„¹ï¸ Optional: Contributing section" >> $GITHUB_STEP_SUMMARY

          if [ "$MISSING_COUNT" -gt 0 ]; then
            echo "" >> $GITHUB_STEP_SUMMARY
            echo "**âš ï¸ $MISSING_COUNT important sections missing**" >> $GITHUB_STEP_SUMMARY
          fi

      - name: Validate CHANGELOG.md
        run: |
          set -x
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "### CHANGELOG.md Analysis" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY

          if [ ! -f "CHANGELOG.md" ]; then
            echo "âŒ **Critical:** CHANGELOG.md not found" >> $GITHUB_STEP_SUMMARY
            exit 1
          fi

          # Analyze changelog structure
          VERSIONS=$(grep -c "## \[" CHANGELOG.md || echo 0)
          UNRELEASED=$(grep -c "## \[Unreleased\]" CHANGELOG.md || echo 0)
          DATES=$(grep -c "[0-9]\{4\}-[0-9]\{2\}-[0-9]\{2\}" CHANGELOG.md || echo 0)
          SIZE=$(wc -c < CHANGELOG.md)

          echo "| Metric | Value | Status | Notes |" >> $GITHUB_STEP_SUMMARY
          echo "|--------|-------|--------|-------|" >> $GITHUB_STEP_SUMMARY

          # Check format
          if grep -qi "## \[.*\]" CHANGELOG.md; then
            echo "| Format | Keep a Changelog | âœ… Pass | Standard format |" >> $GITHUB_STEP_SUMMARY
          else
            echo "| Format | Custom | âš ï¸ Warning | Consider [Keep a Changelog](https://keepachangelog.com/) |" >> $GITHUB_STEP_SUMMARY
          fi

          # Version count
          VERSIONS_STATUS="âœ… Good"
          VERSIONS_NOTE="Well maintained"
          if [ "$VERSIONS" -lt 1 ]; then
            VERSIONS_STATUS="âš ï¸ Warning"
            VERSIONS_NOTE="Add version entries"
          fi
          echo "| Versions | $VERSIONS | $VERSIONS_STATUS | $VERSIONS_NOTE |" >> $GITHUB_STEP_SUMMARY

          # Unreleased section
          if [ "$UNRELEASED" -gt 0 ]; then
            echo "| Unreleased | Yes | âœ… Good | Active development tracked |" >> $GITHUB_STEP_SUMMARY
          else
            echo "| Unreleased | No | â„¹ï¸ Info | Consider adding [Unreleased] section |" >> $GITHUB_STEP_SUMMARY
          fi

          # Dates
          DATES_STATUS="âœ… Good"
          if [ "$DATES" -lt 1 ]; then
            DATES_STATUS="âš ï¸ Warning"
            DATES_NOTE="Add release dates"
          else
            DATES_NOTE="Dates present"
          fi
          echo "| Release dates | $DATES | $DATES_STATUS | $DATES_NOTE |" >> $GITHUB_STEP_SUMMARY

          # Check for standard sections
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "**Changelog Sections:**" >> $GITHUB_STEP_SUMMARY
          grep -qi "### Added" CHANGELOG.md && echo "- âœ… Added section" >> $GITHUB_STEP_SUMMARY || echo "- â„¹ï¸ Added section (optional)" >> $GITHUB_STEP_SUMMARY
          grep -qi "### Changed" CHANGELOG.md && echo "- âœ… Changed section" >> $GITHUB_STEP_SUMMARY || echo "- â„¹ï¸ Changed section (optional)" >> $GITHUB_STEP_SUMMARY
          grep -qi "### Fixed" CHANGELOG.md && echo "- âœ… Fixed section" >> $GITHUB_STEP_SUMMARY || echo "- â„¹ï¸ Fixed section (optional)" >> $GITHUB_STEP_SUMMARY

          echo "" >> $GITHUB_STEP_SUMMARY
          echo "ðŸ“š Reference: [Keep a Changelog](https://keepachangelog.com/)" >> $GITHUB_STEP_SUMMARY

      - name: Check Documentation Index
        run: |
          set -x
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "### Documentation Index" >> $GITHUB_STEP_SUMMARY

          if [ -f "docs/index.md" ] || [ -f "docs/README.md" ]; then
            echo "âœ… Documentation index found" >> $GITHUB_STEP_SUMMARY
          else
            echo "âš ï¸ No documentation index (docs/index.md or docs/README.md)" >> $GITHUB_STEP_SUMMARY
          fi

  coding-standards:
    name: Coding Standards Check
    runs-on: ubuntu-latest

    steps:
      - name: Checkout Repository
        uses: actions/checkout@v4

      - name: Check for Tab Characters
        run: |
          set -x
          echo "### Tab Character Detection" >> $GITHUB_STEP_SUMMARY

          # Find files with tabs (excluding certain file types)
          TABS_FOUND=$(find . -type f \
            ! -path "./vendor/*" \
            ! -path "./node_modules/*" \
            ! -path "./.git/*" \
            ! -name "Makefile*" \
            ! -name "*.tsv" \
            -exec grep -l $'\t' {} \; 2>/dev/null | head -10)

          if [ -n "$TABS_FOUND" ]; then
            echo "âš ï¸ Tab characters found in files:" >> $GITHUB_STEP_SUMMARY
            echo "\`\`\`" >> $GITHUB_STEP_SUMMARY
            echo "$TABS_FOUND" >> $GITHUB_STEP_SUMMARY
            echo "\`\`\`" >> $GITHUB_STEP_SUMMARY
            echo "MokoStandards uses tabs by default (spaces only for languages where tabs break: YAML, Python, Haskell, F#, CoffeeScript, Nim, JSON, RST)" >> $GITHUB_STEP_SUMMARY
          else
            echo "âœ… No inappropriate tab characters found" >> $GITHUB_STEP_SUMMARY
          fi

      - name: Check File Encoding
        run: |
          set -x
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "### File Encoding Check" >> $GITHUB_STEP_SUMMARY

          # Check for UTF-8 encoding (ASCII is a subset of UTF-8 and is acceptable)
          NON_UTF8=$(find . -type f \( -name "*.php" -o -name "*.js" -o -name "*.md" \) \
            ! -path "./vendor/*" \
            ! -path "./node_modules/*" \
            ! -path "./.git/*" \
            -exec file {} \; | grep -v "UTF-8" | grep -v "ASCII" | head -5)

          if [ -n "$NON_UTF8" ]; then
            echo "âš ï¸ Non-UTF-8 files detected:" >> $GITHUB_STEP_SUMMARY
            echo "\`\`\`" >> $GITHUB_STEP_SUMMARY
            echo "$NON_UTF8" >> $GITHUB_STEP_SUMMARY
            echo "\`\`\`" >> $GITHUB_STEP_SUMMARY
          else
            echo "âœ… All source files appear to be UTF-8 encoded" >> $GITHUB_STEP_SUMMARY
          fi

      - name: Check Line Endings
        run: |
          set -x
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "### Line Ending Check" >> $GITHUB_STEP_SUMMARY

          # Check for CRLF line endings
          CRLF_FILES=$(find . -type f \( -name "*.php" -o -name "*.js" -o -name "*.md" \) \
            ! -path "./vendor/*" \
            ! -path "./node_modules/*" \
            ! -path "./.git/*" \
            -exec file {} \; | grep "CRLF" | head -5)

          if [ -n "$CRLF_FILES" ]; then
            echo "âš ï¸ Files with CRLF line endings found:" >> $GITHUB_STEP_SUMMARY
            echo "\`\`\`" >> $GITHUB_STEP_SUMMARY
            echo "$CRLF_FILES" >> $GITHUB_STEP_SUMMARY
            echo "\`\`\`" >> $GITHUB_STEP_SUMMARY
            echo "MokoStandards requires LF line endings" >> $GITHUB_STEP_SUMMARY
          else
            echo "âœ… Line endings are consistent (LF)" >> $GITHUB_STEP_SUMMARY
          fi

  license-compliance:
    name: License Header Validation
    runs-on: ubuntu-latest

    steps:
      - name: Checkout Repository
        uses: actions/checkout@v4

      - name: Check SPDX Headers
        run: |
          set -x
          echo "### SPDX License Header Check" >> $GITHUB_STEP_SUMMARY

          # Count source files with and without SPDX headers
          TOTAL_PHP=0
          WITH_SPDX_PHP=0

          if find . -name "*.php" -type f ! -path "./vendor/*" | head -1 | grep -q .; then
            TOTAL_PHP=$(find . -name "*.php" -type f ! -path "./vendor/*" | wc -l)
            WITH_SPDX_PHP=$(find . -name "*.php" -type f ! -path "./vendor/*" -exec grep -l "SPDX-License-Identifier" {} \; | wc -l)
          fi

          if [ "$TOTAL_PHP" -gt 0 ]; then
            PERCENT=$((WITH_SPDX_PHP * 100 / TOTAL_PHP))
            echo "- PHP files: $WITH_SPDX_PHP/$TOTAL_PHP ($PERCENT%) with SPDX headers" >> $GITHUB_STEP_SUMMARY

            if [ "$PERCENT" -lt 80 ]; then
              echo "âš ï¸ Less than 80% of PHP files have SPDX headers" >> $GITHUB_STEP_SUMMARY
            else
              echo "âœ… Good SPDX header coverage" >> $GITHUB_STEP_SUMMARY
            fi
          fi

      - name: Validate License File
        run: |
          set -x
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "### License File Validation" >> $GITHUB_STEP_SUMMARY

          if [ ! -f "LICENSE" ]; then
            echo "âŒ LICENSE file not found" >> $GITHUB_STEP_SUMMARY
            exit 1
          fi

          # Check license type
          if grep -qi "GNU GENERAL PUBLIC LICENSE" LICENSE; then
            VERSION=$(grep -i "Version 3" LICENSE || echo "")
            if [ -n "$VERSION" ]; then
              echo "âœ… GPL-3.0-or-later license detected" >> $GITHUB_STEP_SUMMARY
            else
              echo "âš ï¸ GPL license detected but version unclear" >> $GITHUB_STEP_SUMMARY
            fi
          elif grep -qi "MIT License" LICENSE; then
            echo "âœ… MIT license detected" >> $GITHUB_STEP_SUMMARY
          elif grep -qi "Apache License" LICENSE; then
            echo "âœ… Apache license detected" >> $GITHUB_STEP_SUMMARY
          else
            echo "â„¹ï¸ License type could not be automatically detected" >> $GITHUB_STEP_SUMMARY
          fi

  git-hygiene:
    name: Git Repository Hygiene
    runs-on: ubuntu-latest

    steps:
      - name: Checkout Repository
        uses: actions/checkout@v4
        with:
          fetch-depth: 0

      - name: Check .gitignore
        run: |
          set -x
          echo "### .gitignore Validation" >> $GITHUB_STEP_SUMMARY

          if [ ! -f ".gitignore" ]; then
            echo "âš ï¸ .gitignore file not found" >> $GITHUB_STEP_SUMMARY
            exit 0
          fi

          # Check for common exclusions
          MISSING=""
          grep -q "vendor/" .gitignore || MISSING="${MISSING}vendor/ "
          grep -q "node_modules/" .gitignore || MISSING="${MISSING}node_modules/ "

          if [ -n "$MISSING" ]; then
            echo "âš ï¸ .gitignore may be missing common exclusions: $MISSING" >> $GITHUB_STEP_SUMMARY
          else
            echo "âœ… .gitignore appears complete" >> $GITHUB_STEP_SUMMARY
          fi

      - name: Check for Large Files
        run: |
          set -x
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "### Large File Detection" >> $GITHUB_STEP_SUMMARY

          # Find files larger than 1MB
          LARGE_FILES=$(find . -type f -size +1M ! -path "./.git/*" ! -path "./vendor/*" ! -path "./node_modules/*" | head -5)

          if [ -n "$LARGE_FILES" ]; then
            echo "âš ï¸ Large files detected (>1MB):" >> $GITHUB_STEP_SUMMARY
            echo "\`\`\`" >> $GITHUB_STEP_SUMMARY
            echo "$LARGE_FILES" >> $GITHUB_STEP_SUMMARY
            echo "\`\`\`" >> $GITHUB_STEP_SUMMARY
            echo "Consider using Git LFS for large binary files" >> $GITHUB_STEP_SUMMARY
          else
            echo "âœ… No unusually large files detected" >> $GITHUB_STEP_SUMMARY
          fi

  workflow-validation:
    name: Workflow Configuration Check
    runs-on: ubuntu-latest

    steps:
      - name: Checkout Repository
        uses: actions/checkout@v4

      - name: Check Required Workflows
        run: |
          set -x
          echo "### GitHub Actions Workflows" >> $GITHUB_STEP_SUMMARY

          WORKFLOWS_DIR=".github/workflows"

          if [ ! -d "$WORKFLOWS_DIR" ]; then
            echo "âŒ No workflows directory found" >> $GITHUB_STEP_SUMMARY
            exit 1
          fi

          # Check for recommended workflows
          if [ -f "$WORKFLOWS_DIR/ci.yml" ] || [ -f "$WORKFLOWS_DIR/build.yml" ]; then
            echo "âœ… CI workflow present" >> $GITHUB_STEP_SUMMARY
          else
            echo "âš ï¸ No CI workflow found (ci.yml or build.yml)" >> $GITHUB_STEP_SUMMARY
          fi

          if [ -f "$WORKFLOWS_DIR/codeql-analysis.yml" ]; then
            echo "âœ… CodeQL security scanning present" >> $GITHUB_STEP_SUMMARY
          else
            echo "âš ï¸ CodeQL workflow not found" >> $GITHUB_STEP_SUMMARY
          fi

      - name: Validate Workflow Syntax
        run: |
          set -x
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "### Workflow YAML Syntax" >> $GITHUB_STEP_SUMMARY

          INVALID=0
          for workflow in $(find .github/workflows -maxdepth 1 -type f \( -name "*.yml" -o -name "*.yaml" \) 2>/dev/null); do
            if [ -f "$workflow" ]; then
              if python3 -c "import yaml; yaml.safe_load(open('$workflow'))" 2>/dev/null; then
                echo "âœ… $(basename $workflow)" >> $GITHUB_STEP_SUMMARY
              else
                echo "âŒ $(basename $workflow) - invalid YAML" >> $GITHUB_STEP_SUMMARY
                INVALID=$((INVALID + 1))
              fi
            fi
          done

          if [ "$INVALID" -gt 0 ]; then
            exit 1
          fi

      - name: Setup Python for CodeQL Validation
        if: hashFiles('.github/workflows/codeql-analysis.yml') != ''
        uses: actions/setup-python@v5
        with:
          python-version: '3.x'

      - name: Install PyYAML for CodeQL Validation
        if: hashFiles('.github/workflows/codeql-analysis.yml') != ''
        run: pip install pyyaml

      - name: Validate CodeQL Configuration
        if: hashFiles('.github/workflows/codeql-analysis.yml') != ''
        run: |
          set -x
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "### CodeQL Language Configuration" >> $GITHUB_STEP_SUMMARY

          # Download validation script from MokoStandards
          SCRIPT_URL="https://raw.githubusercontent.com/mokoconsulting-tech/MokoStandards/main/scripts/validate/validate_codeql_config.py"
          EXPECTED_SHA256="3c07f9e7ba50a51718dfb548d1105770a369cb0e1ece46d8e1f1765ad7bb09c9"

          curl -sSL "$SCRIPT_URL" -o /tmp/validate_codeql_config.py

          # Verify SHA-256 hash
          ACTUAL_SHA256=$(sha256sum /tmp/validate_codeql_config.py | cut -d' ' -f1)
          if [ "$ACTUAL_SHA256" != "$EXPECTED_SHA256" ]; then
            echo "âŒ SHA-256 verification failed for downloaded script" >> $GITHUB_STEP_SUMMARY
            echo "Expected: $EXPECTED_SHA256" >> $GITHUB_STEP_SUMMARY
            echo "Actual: $ACTUAL_SHA256" >> $GITHUB_STEP_SUMMARY
            exit 1
          fi

          # Run validation
          if python3 /tmp/validate_codeql_config.py > /tmp/codeql_validation.txt 2>&1; then
            echo "âœ… CodeQL language configuration is valid" >> $GITHUB_STEP_SUMMARY
            echo "" >> $GITHUB_STEP_SUMMARY
            echo "\`\`\`" >> $GITHUB_STEP_SUMMARY
            cat /tmp/codeql_validation.txt >> $GITHUB_STEP_SUMMARY
            echo "\`\`\`" >> $GITHUB_STEP_SUMMARY
          else
            echo "âŒ CodeQL language configuration has issues" >> $GITHUB_STEP_SUMMARY
            echo "" >> $GITHUB_STEP_SUMMARY
            echo "\`\`\`" >> $GITHUB_STEP_SUMMARY
            cat /tmp/codeql_validation.txt >> $GITHUB_STEP_SUMMARY
            echo "\`\`\`" >> $GITHUB_STEP_SUMMARY
            echo "" >> $GITHUB_STEP_SUMMARY
            echo "**Action Required:** CodeQL is configured to analyze languages that don't exist in your repository." >> $GITHUB_STEP_SUMMARY
            echo "This will cause CI failures. Please update .github/workflows/codeql-analysis.yml to only include" >> $GITHUB_STEP_SUMMARY
            echo "languages that are actually present in your codebase." >> $GITHUB_STEP_SUMMARY
            exit 1
          fi

  summary:
    name: Compliance Summary
    runs-on: ubuntu-latest
    needs: [repository-structure, documentation-quality, coding-standards, license-compliance, git-hygiene, workflow-validation]
    if: always()

    steps:
      - name: Generate Compliance Report
        run: |
          set -x
          echo "# ðŸ“Š MokoStandards Compliance Report" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY

          # Calculate overall status
          REPO_STATUS="${{ needs.repository-structure.result }}"
          DOCS_STATUS="${{ needs.documentation-quality.result }}"
          CODE_STATUS="${{ needs.coding-standards.result }}"
          LICENSE_STATUS="${{ needs.license-compliance.result }}"
          GIT_STATUS="${{ needs.git-hygiene.result }}"
          WORKFLOW_STATUS="${{ needs.workflow-validation.result }}"

          PASSED=0
          FAILED=0
          TOTAL=6

          [ "$REPO_STATUS" = "success" ] && PASSED=$((PASSED + 1)) || FAILED=$((FAILED + 1))
          [ "$DOCS_STATUS" = "success" ] && PASSED=$((PASSED + 1)) || FAILED=$((FAILED + 1))
          [ "$CODE_STATUS" = "success" ] && PASSED=$((PASSED + 1)) || FAILED=$((FAILED + 1))
          [ "$LICENSE_STATUS" = "success" ] && PASSED=$((PASSED + 1)) || FAILED=$((FAILED + 1))
          [ "$GIT_STATUS" = "success" ] && PASSED=$((PASSED + 1)) || FAILED=$((FAILED + 1))
          [ "$WORKFLOW_STATUS" = "success" ] && PASSED=$((PASSED + 1)) || FAILED=$((FAILED + 1))

          COMPLIANCE_PERCENT=$((PASSED * 100 / TOTAL))

          # Overall status badge
          if [ "$COMPLIANCE_PERCENT" -eq 100 ]; then
            echo "## âœ… Overall Status: **COMPLIANT** ($COMPLIANCE_PERCENT%)" >> $GITHUB_STEP_SUMMARY
          elif [ "$COMPLIANCE_PERCENT" -ge 80 ]; then
            echo "## âš ï¸ Overall Status: **MOSTLY COMPLIANT** ($COMPLIANCE_PERCENT%)" >> $GITHUB_STEP_SUMMARY
          elif [ "$COMPLIANCE_PERCENT" -ge 50 ]; then
            echo "## âš ï¸ Overall Status: **PARTIALLY COMPLIANT** ($COMPLIANCE_PERCENT%)" >> $GITHUB_STEP_SUMMARY
          else
            echo "## âŒ Overall Status: **NON-COMPLIANT** ($COMPLIANCE_PERCENT%)" >> $GITHUB_STEP_SUMMARY
          fi

          echo "" >> $GITHUB_STEP_SUMMARY
          echo "**Score:** $PASSED/$TOTAL validation areas passed" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY

          # Progress bar
          FILLED=$((COMPLIANCE_PERCENT / 5))
          EMPTY=$((20 - FILLED))
          BAR=""
          for i in $(seq 1 $FILLED); do BAR="${BAR}â–ˆ"; done
          for i in $(seq 1 $EMPTY); do BAR="${BAR}â–‘"; done
          echo "\`\`\`" >> $GITHUB_STEP_SUMMARY
          echo "$BAR $COMPLIANCE_PERCENT%" >> $GITHUB_STEP_SUMMARY
          echo "\`\`\`" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY

          # Detailed breakdown
          echo "## Validation Results" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "| Area | Status | Result | Priority |" >> $GITHUB_STEP_SUMMARY
          echo "|------|--------|--------|----------|" >> $GITHUB_STEP_SUMMARY

          # Repository Structure
          if [ "$REPO_STATUS" = "success" ]; then
            echo "| ðŸ“ Repository Structure | âœ… Pass | Compliant | - |" >> $GITHUB_STEP_SUMMARY
          else
            echo "| ðŸ“ Repository Structure | âŒ Fail | **Action Required** | ðŸ”´ Critical |" >> $GITHUB_STEP_SUMMARY
          fi

          # Documentation Quality
          if [ "$DOCS_STATUS" = "success" ]; then
            echo "| ðŸ“š Documentation Quality | âœ… Pass | Compliant | - |" >> $GITHUB_STEP_SUMMARY
          else
            echo "| ðŸ“š Documentation Quality | âŒ Fail | **Action Required** | ðŸ”´ Critical |" >> $GITHUB_STEP_SUMMARY
          fi

          # Coding Standards
          if [ "$CODE_STATUS" = "success" ]; then
            echo "| ðŸ’» Coding Standards | âœ… Pass | Compliant | - |" >> $GITHUB_STEP_SUMMARY
          else
            echo "| ðŸ’» Coding Standards | âš ï¸ Warning | Review Recommended | ðŸŸ¡ Medium |" >> $GITHUB_STEP_SUMMARY
          fi

          # License Compliance
          if [ "$LICENSE_STATUS" = "success" ]; then
            echo "| âš–ï¸ License Compliance | âœ… Pass | Compliant | - |" >> $GITHUB_STEP_SUMMARY
          else
            echo "| âš–ï¸ License Compliance | âŒ Fail | **Action Required** | ðŸ”´ Critical |" >> $GITHUB_STEP_SUMMARY
          fi

          # Git Hygiene
          if [ "$GIT_STATUS" = "success" ]; then
            echo "| ðŸ§¹ Git Repository Hygiene | âœ… Pass | Compliant | - |" >> $GITHUB_STEP_SUMMARY
          else
            echo "| ðŸ§¹ Git Repository Hygiene | âš ï¸ Warning | Review Recommended | ðŸŸ¡ Medium |" >> $GITHUB_STEP_SUMMARY
          fi

          # Workflow Configuration
          if [ "$WORKFLOW_STATUS" = "success" ]; then
            echo "| âš™ï¸ Workflow Configuration | âœ… Pass | Compliant | - |" >> $GITHUB_STEP_SUMMARY
          else
            echo "| âš™ï¸ Workflow Configuration | âš ï¸ Warning | Review Recommended | ðŸŸ¡ Medium |" >> $GITHUB_STEP_SUMMARY
          fi

          echo "" >> $GITHUB_STEP_SUMMARY

          # Action items summary
          if [ "$FAILED" -gt 0 ]; then
            echo "## âš¡ Action Items" >> $GITHUB_STEP_SUMMARY
            echo "" >> $GITHUB_STEP_SUMMARY
            echo "**$FAILED validation area(s) require attention:**" >> $GITHUB_STEP_SUMMARY
            echo "" >> $GITHUB_STEP_SUMMARY

            [ "$REPO_STATUS" != "success" ] && echo "- ðŸ”´ **Critical:** Fix repository structure issues" >> $GITHUB_STEP_SUMMARY
            [ "$DOCS_STATUS" != "success" ] && echo "- ðŸ”´ **Critical:** Improve documentation quality" >> $GITHUB_STEP_SUMMARY
            [ "$LICENSE_STATUS" != "success" ] && echo "- ðŸ”´ **Critical:** Resolve license compliance issues" >> $GITHUB_STEP_SUMMARY
            [ "$CODE_STATUS" != "success" ] && echo "- ðŸŸ¡ **Medium:** Review coding standards violations" >> $GITHUB_STEP_SUMMARY
            [ "$GIT_STATUS" != "success" ] && echo "- ðŸŸ¡ **Medium:** Address git repository hygiene items" >> $GITHUB_STEP_SUMMARY
            [ "$WORKFLOW_STATUS" != "success" ] && echo "- ðŸŸ¡ **Medium:** Review workflow configuration" >> $GITHUB_STEP_SUMMARY

            echo "" >> $GITHUB_STEP_SUMMARY
            echo "**Next Steps:**" >> $GITHUB_STEP_SUMMARY
            echo "1. Review detailed results in individual job outputs above" >> $GITHUB_STEP_SUMMARY
            echo "2. Follow remediation steps provided for each failure" >> $GITHUB_STEP_SUMMARY
            echo "3. Re-run this workflow after making corrections" >> $GITHUB_STEP_SUMMARY
            echo "4. Reach 100% compliance before merging" >> $GITHUB_STEP_SUMMARY
          else
            echo "## ðŸŽ‰ Excellent!" >> $GITHUB_STEP_SUMMARY
            echo "" >> $GITHUB_STEP_SUMMARY
            echo "Your repository is **fully compliant** with MokoStandards!" >> $GITHUB_STEP_SUMMARY
            echo "" >> $GITHUB_STEP_SUMMARY
            echo "**Achievements:**" >> $GITHUB_STEP_SUMMARY
            echo "- âœ… All required directories and files present" >> $GITHUB_STEP_SUMMARY
            echo "- âœ… Documentation meets quality standards" >> $GITHUB_STEP_SUMMARY
            echo "- âœ… Coding standards followed" >> $GITHUB_STEP_SUMMARY
            echo "- âœ… License compliance verified" >> $GITHUB_STEP_SUMMARY
            echo "- âœ… Git repository well-maintained" >> $GITHUB_STEP_SUMMARY
            echo "- âœ… Workflows properly configured" >> $GITHUB_STEP_SUMMARY
          fi

          echo "" >> $GITHUB_STEP_SUMMARY
          echo "---" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "ðŸ“š **Resources:**" >> $GITHUB_STEP_SUMMARY
          echo "- [MokoStandards Documentation](https://github.com/mokoconsulting-tech/MokoStandards)" >> $GITHUB_STEP_SUMMARY
          echo "- [Repository Structure Guide](https://github.com/mokoconsulting-tech/MokoStandards/tree/main/docs/policy/core-structure.md)" >> $GITHUB_STEP_SUMMARY
          echo "- [Documentation Standards](https://github.com/mokoconsulting-tech/MokoStandards/tree/main/docs/policy/document-formatting.md)" >> $GITHUB_STEP_SUMMARY
          echo "- [Coding Standards](https://github.com/mokoconsulting-tech/MokoStandards/tree/main/docs/policy/coding-style-guide.md)" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "_Generated by MokoStandards Compliance Workflow v02.00.00_" >> $GITHUB_STEP_SUMMARY

          # Create tracking issue for non-compliance if on push
          if [ "$COMPLIANCE_PERCENT" -lt 100 ] && [ "${{ github.event_name }}" = "push" ]; then
            echo "Creating tracking issue for standards violations..."
          fi

          # Exit with error if not fully compliant
          if [ "$COMPLIANCE_PERCENT" -lt 100 ]; then
            exit 1
          fi

      - name: Create tracking issue for standards violations
        if: failure() && github.event_name == 'push'
        uses: actions/github-script@v7
        with:
          script: |
            const compliancePercent = '${{ needs.compliance-check.outputs.compliance_percentage }}' || '0';
            const failedChecks = [];

            // Collect failed checks from job outputs
            const jobs = [
              { name: 'File Headers', failed: '${{ needs.compliance-check.outputs.headers_ok }}' !== 'true' },
              { name: 'Required Files', failed: '${{ needs.compliance-check.outputs.required_files_ok }}' !== 'true' },
              { name: 'Documentation', failed: '${{ needs.compliance-check.outputs.documentation_ok }}' !== 'true' },
              { name: 'Code Quality', failed: '${{ needs.compliance-check.outputs.code_quality_ok }}' !== 'true' }
            ];

            jobs.forEach(job => {
              if (job.failed) failedChecks.push(job.name);
            });

            const body = `## ðŸ“‹ Standards Compliance Violations Detected

            **Branch**: \`${context.ref}\`
            **Commit**: ${context.sha.substring(0, 7)}
            **Triggered by**: @${context.actor}
            **Date**: ${new Date().toISOString()}

            ### Compliance Score: ${compliancePercent}%

            ### âŒ Failed Checks
            ${failedChecks.length > 0 ? failedChecks.map(check => `- ${check}`).join('\n') : '_Details available in workflow run_'}

            ### ðŸ“Š What This Means
            Your repository does not meet the required MokoStandards compliance threshold. This can affect:
            - Code quality and maintainability
            - Team collaboration efficiency
            - Automated tooling integration
            - Repository discoverability

            ### âœ… Required Actions
            1. Review the [workflow run](${context.payload.repository.html_url}/actions/runs/${context.runId}) for detailed findings
            2. Address each failed check according to MokoStandards documentation
            3. Push changes to trigger a new compliance scan
            4. Ensure compliance reaches 100% before merging

            ### ðŸ“š Resources
            - [MokoStandards Documentation](https://github.com/mokoconsulting-tech/MokoStandards)
            - [Repository Structure Guide](https://github.com/mokoconsulting-tech/MokoStandards/tree/main/docs/policy/core-structure.md)
            - [Documentation Standards](https://github.com/mokoconsulting-tech/MokoStandards/tree/main/docs/policy/document-formatting.md)
            - [Coding Standards](https://github.com/mokoconsulting-tech/MokoStandards/tree/main/docs/policy/coding-style-guide.md)

            ### ðŸ”„ Resolution
            This issue will be automatically closed when compliance reaches 100%.

            ---
            *This issue was automatically created by the Standards Compliance workflow.*
            `;

            // Check for existing open issue
            const issues = await github.rest.issues.listForRepo({
              owner: context.repo.owner,
              repo: context.repo.repo,
              state: 'open',
              labels: 'standards-violation',
              per_page: 1
            });

            if (issues.data.length > 0) {
              // Update existing issue
              await github.rest.issues.createComment({
                owner: context.repo.owner,
                repo: context.repo.repo,
                issue_number: issues.data[0].number,
                body: `### ðŸ”„ Updated Scan Results\n\n${body}`
              });
              console.log(`Updated existing issue #${issues.data[0].number}`);
            } else {
              // Create new issue
              const issue = await github.rest.issues.create({
                owner: context.repo.owner,
                repo: context.repo.repo,
                title: `[Standards] Compliance Violations - ${new Date().toISOString().split('T')[0]}`,
                body: body,
                labels: ['standards-violation', 'compliance', 'automation'],
                assignees: ['copilot', 'jmiller-moko']
              });
              console.log(`Created new issue #${issue.data.number}`);
            }

# CUSTOMIZATION:
#
# 1. Adjust severity of checks (convert warnings to errors or vice versa)
# 2. Add project-specific validation rules
# 3. Integrate with custom linting tools
# 4. Add notification steps for compliance failures
# 5. Customize required files/directories for your project type
